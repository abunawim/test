select ADMISSION_ID, YEAR_MAP_ID, YEAR_NAME, ITEM_NO, ITEM_NAME, avg(S_PRICE)*TIMES BILL_AMT,sum(S_PRICE) S_PRICE,
sum(ITEM_QTY) ITEM_QTY, sum(TOT_PRICE) TOT_PRICE, sum(DISCOUNT) DISCOUNT, TIMES
from
(select ADMISSION_ID, YEAR_MAP_ID, YEAR_NAME, ITEM_NO, ITEM_NAME, BILL_AMT,S_PRICE,
ITEM_QTY, TOT_PRICE, DISCOUNT,
(select TIMES
from nm_feehead_map
where YEAR_MAPP_ID = NMV_COLLECTIONDETAILS.YEAR_MAP_ID
and FEEHEAD_ID= NMV_COLLECTIONDETAILS.ITEM_NO) TIMES
from NMV_COLLECTIONDETAILS)
where ADMISSION_ID = :P_ADMISSION_ID 
group by ADMISSION_ID, YEAR_NAME, ITEM_NO, ITEM_NAME, YEAR_MAP_ID, TIMES
order by YEAR_NAME;

